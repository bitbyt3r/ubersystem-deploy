---
# -----------------
# logstashforwarder stuff
# run on NODES to send their logfiles back to the master control server running logstash
# -----------------

logstashforwarder::ssl_key:         'puppet:///modules/uber/selfsigned-host.key'
logstashforwarder::ssl_ca:          'puppet:///modules/uber/selfsigned-rootCA.crt'
logstashforwarder::ssl_cert:        'puppet:///modules/uber/selfsigned-host.crt'
logstashforwarder::manage_repo:     true
logstashforwarder::servers:
  - 'localhost'

logstashforwarder_files:
  syslog:
    paths:
    - '/var/log/syslog'
    fields:
      type: 'syslog'

# -----------------
# logstash stuff
# run on LOGGING SERVER to collect logs from all the NODES
# -----------------
logstash::manage_repo: true
logstash::repo_version: '1.4'
logstash::java_install: true
# logstash::install_contrib: true
# logstash::contrib_version: '1.4'

logstash_configs:
  input-lumberjack:
    template: "logstash/uber-contrib/uber-input-logstashforwarder.erb"
    order: 10
  filter-main:
    template: "logstash/uber-contrib/uber-filters.erb"
    order: 20
  outputs:
    template: "logstash/uber-contrib/uber-outputs.erb"
    order: 30


# -----------------
# Elastisearch stuff
# run on LOGGING SERVER to be a database for logs from all the NODES
# -----------------

elasticsearch::manage_repo: true
elasticsearch::repo_version: '1.3'

elastisearch_instances:
  main:
    ensure: 'present'


